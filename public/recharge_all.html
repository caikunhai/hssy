<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>管理平台</title>
	<link rel="stylesheet" type="text/css" href="css/css.css" />
	<link rel="stylesheet" type="text/css" href="js/themes/default/easyui.css" />
	<link rel="stylesheet" type="text/css" href="css/icon.css">
	<script type="text/javascript" src="js/jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="js/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="js/core.js"></script>
    <script type="text/javascript" src="js/bns.js"></script>
    <script type="text/javascript" src="js/util.date.js"></script>
</head>
<body>
	<table style="width:100%" id="dg" data-options="
                rownumbers:true,
                singleSelect:true,
                autoRowHeight:false,
                pagination:true,
                pageSize:10">
		<thead>
			<tr>
				<th field="code" width="10%">充值编号</th>
				<th field="actual" width="10%">充值金额</th>
				<th field="createdUser" width="10%">充值账户</th>
				<th field="state" width="10%">充值状态</th>
				<th field="createdTime" width="10%">充值时间</th>
				<th field="allowance" width="10%">赠送金额</th>
				<th field="checkedUser" width="10%">审核人</th>
				<th field="updateTime" width="10%">审核时间</th>
				<th field="operation">操作</th>
			</tr>
		</thead>
	</table>
	
	<div id="w" class="easyui-window" title="发放充值" collapsible="false" minimizable="false" closed="true"
        maximizable="false"  style="width: 300px; height: 150px; padding: 5px;background: #fafafa;">
        <div class="easyui-layout" fit="true">
            <div region="center" border="false" style="padding: 10px; background: #fff; border: 1px solid #ccc;">
                <div style="margin-bottom:14px">
					<input class="easyui-textbox" data-options="label:'赠送金额:'" id="allowance" style="width: 240px;">
				</div>
            </div>
            <div region="south" border="false" style="text-align: center; height: 36px;padding-top: 10px;">
                <a class="easyui-linkbutton" href="javascript:void(0);">确定发放</a> 
                <a class="easyui-linkbutton" href="javascript:$('#w').window('close');">取消</a>
            </div>
        </div>
    </div> 
	
<script>
	$(function(){
		bns.recharge_all(list_html);
	});
	
	//列表数据
	function list_html(data){
		var xhrObj = JSON.parse(data);
		var rows = [];
		for(var i=0;i<xhrObj.length;i++){
			var operation_html ='';
			if(xhrObj[i].state==0){
				operation_html ='<a href=javascript:openW("'+xhrObj[i].id+'"); >发放</a>';
			}
			rows.push({
			    code: xhrObj[i].code,
				actual: xhrObj[i].actual,
				createdUser: xhrObj[i].createdUser,
				state:xhrObj[i].state==0?'待到账':'已到账',
				createdTime:time.formatterDate(new Date(xhrObj[i].createdTime)),
				allowance: xhrObj[i].allowance,
				checkedUser:xhrObj[i].checkedUser,
				updateTime:xhrObj[i].updateTime,
				operation:operation_html
			});
		}
        $('#dg').datagrid({loadFilter:pagerFilter}).datagrid('loadData', rows);
	}
	
	function openW(id){
		$('#w').window('open');
	}
</script>
</body>
</html>